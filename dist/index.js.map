{"version":3,"sources":["../src/index.js"],"names":["EQUALS","EQ","GREATER","GT","GREATER_OR_EQUALS","GTE","LESS","LT","LESS_OR_EQUALS","LTE","NOT_EQUALS","NE","BETWEEN","AND","Consts","SQLObject","Conditions","args","arg","push","length","toString","Disjunction","self","map","_argToStr","join","Conjunction","Condition","column","operator","value","quoteTerm","quoteVal","Negation","InclusionOperator","inclusionType","Array","isArray","val","In","values","NotIn","GlobalNotIn","GlobalIn","Between","leftBoundary","rightBoundary","b","quoteBoundary","Operators","createCondition","Error","commonReplacer","s","console","error","Value","replace","Term","term","parts","split","Number","isFinite","SQLFunction","name","_curry_f","AggregateFunctions","count","any","anyLast","min","max","sum","avg","uniq","uniqCombined","uniqHLL12","uniqExact","groupArray","groupUniqArray","ArithmeticFunctions","plus","minus","multiply","divide","intDiv","intDivOrZero","modulo","negate","abs","TimeFunctions","toYear","toMonth","toDayOfMonth","toDayOfWeek","toHour","toMinute","toTime","toDate","toDateTime","toDateTime64","toStartOfDay","toStartOfMonth","toStartOfQuarter","toStartOfYear","toStartOfMinute","toStartOfFiveMinute","toStartOfHour","now","today","yesterday","IPAddrFunctions","toIPv4","toIPv6","IPv4NumToString","IPv4StringToNum","IPv4NumToStringClassC","IPv6NumToString","IPv6StringToNum","Raw","string","raw","Query","Parameter","With","alias","query","inline","Select","fmt","undefined","WithReference","ref","Subquery","UnionAll","queries","_init","q","ctx","dist","params","withs","tables","joins","conditions","having_conditions","preconditions","aggregations","select_list","order_expressions","request_totals","sampling","limits","limitbycolumns","columns","forEach","col","apply","Object","param","table","keys","type","condition","aggregateExpressions","a","number","offset","limit","expressions","wth","filter","w","c","from","prewhere","where","groupby","having","order_by","e","with_totals","sample","limitby","format","toUpperCase","v","Queries","Utility","Shortcuts","And","Or","Eq","Ne","Gte","Lte","Lt","Gt","notIn","cast","thing","t","between","left","right","Dialect"],"mappings":"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","sourcesContent":["const EQUALS = \"=\";\nconst EQ = EQUALS;\nconst GREATER = \">\";\nconst GT = GREATER;\nconst GREATER_OR_EQUALS = \">=\";\nconst GTE = GREATER_OR_EQUALS;\nconst LESS = \"<\";\nconst LT = LESS;\nconst LESS_OR_EQUALS = \"<=\";\nconst LTE = LESS_OR_EQUALS;\nconst NOT_EQUALS = \"!=\";\nconst NE = NOT_EQUALS;\nconst BETWEEN = \"between\";\nconst AND = 'and'\n\nconst Consts = {\n  EQUALS,\n  GREATER,\n  GREATER_OR_EQUALS,\n  LESS,\n  LESS_OR_EQUALS,\n  NOT_EQUALS,\n  EQ,\n  GT,\n  GTE,\n  LT,\n  LTE,\n  NE,\n};\n\nclass SQLObject {\n}\n\nclass Conditions extends SQLObject {\n  constructor(...args) {\n    super();\n    this.args = args;\n  }\n\n  push(arg) {\n    this.args.push(arg);\n  }\n\n  get length() {\n    return this.args.length;\n  }\n\n  _argToStr(arg) {\n    return (arg.toString) ? arg.toString() : arg;\n  }\n\n}\n\nclass Disjunction extends Conditions {\n  constructor(...args) {\n    super(...args);\n  }\n\n  toString() {\n    const self = this;\n    return this.args.length ? this.args.map(arg => `(${self._argToStr(arg)})`).join(\" or \") : \"\";\n  }\n}\n\nclass Conjunction extends Conditions {\n  constructor(...args) {\n    super(...args);\n  }\n\n  toString() {\n    if (!this.args.length) return \"\";\n    const self = this;\n    return this.args.map((arg) => `(${self._argToStr(arg)})`).join(\" and \");\n  }\n}\n\nclass Condition extends SQLObject {\n  constructor(column, operator, value) {\n    super();\n    this.column = quoteTerm(column);\n    this.operator = operator;\n    this.value = (value instanceof SQLObject) ? value : quoteVal(value);\n  }\n\n  toString() {\n    if (this.operator) {\n      return [this.column, this.operator, this.value].join(' ');\n    } else {\n      return this.column;\n    }\n  }\n}\n\nclass Negation extends Condition {\n  constructor(column, operator, value) {\n    super(column, operator, value);\n  }\n\n  toString() {\n    return \"not(\" + super.toString() + \")\";\n  }\n}\n\nclass InclusionOperator extends Condition {\n  constructor(inclusionType, column, operator, value) {\n    super(column, operator, value);\n    this.operator = inclusionType;\n  }\n\n  toString() {\n    return [\n      quoteTerm(this.column),\n      \" \",\n      this.operator,\n      \" (\",\n      Array.isArray(this.value)\n        ? this.value.map(val => quoteVal(val)).join(',')\n        : quoteVal(this.value),\n      \")\"\n    ].join('');\n  }\n}\n\nclass In extends InclusionOperator {\n  constructor(column, operator, values) {\n    super(\"in\", column, operator, values);\n  }\n}\n\nclass NotIn extends InclusionOperator {\n  constructor(column, operator, values) {\n    super(\"not in\", column, operator, values);\n  }\n}\n\nclass GlobalNotIn extends InclusionOperator {\n  constructor(column, operator, values) {\n    super(\"global not in\", column, operator, values);\n  }\n}\n\nclass GlobalIn extends InclusionOperator {\n  constructor(column, operator, values) {\n    super(\"global in\", column, operator, values);\n  }\n}\n\nclass Between extends SQLObject {\n  constructor(column, leftBoundary, rightBoundary) {\n      super();\n      this.column = column;\n\n      this.leftBoundary = leftBoundary;\n      this.rightBoundary = rightBoundary;\n  }\n  quoteBoundary(b) {\n    return b instanceof SQLObject ? b.toString() : quoteVal(b);\n  }\n\n  toString() {\n    return [\n      quoteTerm(this.column),\n      \" \",\n      BETWEEN,\n      // because super class adding parents around value and I didn't find an elegant\n      // way how to avoid this. So I'm overloading toString() and copy-pasting implementation\n      this.quoteBoundary(this.leftBoundary),\n      AND,\n      this.quoteBoundary(this.rightBoundary)\n    ].join(' ');\n  }\n}\n\nconst Operators = {\n  Conjunction, Disjunction, Negation,\n  In, NotIn, GlobalIn, GlobalNotIn\n};\n\nfunction createCondition(...args) {\n  switch (args.length) {\n    case 1:\n      return args[0] instanceof Condition ? args[0] : new Condition(args[0]);\n    case 2:\n      return new Condition(args[0], EQUALS, args[1]);\n    case 3:\n      return new Condition(...args);\n    default:\n      throw new Error(\"Invalid condition args: \", args);\n  }\n}\n\nlet commonReplacer = [\n  /[\\0\\n\\r\\b\\t\\\\\\x1a]/g, (s) => {\n    switch (s) {\n      case \"\\0\":\n        return \"\\\\0\";\n      case \"\\n\":\n        return \"\\\\n\";\n      case \"\\b\":\n        return \"\\\\b\";\n      case \"\\r\":\n        return \"\\\\r\";\n      case \"\\t\":\n        return \"\\\\t\";\n      case \"\\\\\":\n        return \"\\\\\\\\\";\n      case \"\\x1a\" :\n        return \"\\\\Z\";\n      default:\n        console.error(\"uncovered case in replacer:\", s); return ''; //logic error\n    }\n  }\n];\n\nclass Value extends SQLObject {\n  constructor(value) {\n    super();\n    this.value = value;\n  }\n\n  toString() {\n    if (typeof this.value === \"string\") {\n      return \"'\" + this.value.replace(...commonReplacer).replace(/'/g, \"''\") + \"'\";\n    }\n    if (typeof this.value === 'undefined') {\n      return \"''\";\n    }\n\n    if (Array.isArray(this.value)) {\n      return this.value.map(val => new Value(val)).join();\n    }\n\n    return this.value + '';\n  }\n}\n\nclass Term extends SQLObject {\n  constructor(term) {\n    super();\n    this.term = term;\n  }\n\n  toString() {\n    const parts = this.term.split('.');\n    if (parts.length > 1) {\n      return [new Term(parts[0]).toString(), new Term(parts[1]).toString()].join('.');\n    }\n\n    return '`' + this.term.replace(...commonReplacer).replace(/`/g, '\\\\`') + '`';\n  }\n}\n\nfunction quoteVal(value) {\n  return value instanceof SQLObject ? value : new Value(value);\n}\n\nfunction quoteTerm(term) {\n  return term instanceof SQLObject || Number.isFinite(term) ? term : new Term(term);\n}\n\n\nclass SQLFunction extends SQLObject {\n  constructor(name, ...args) {\n    super();\n    this.name = name;\n    this.args = args;\n  }\n\n  toString() {\n    return this.name +\n      \"(\" +\n      this.args.map((arg) => arg instanceof SQLObject || Number.isFinite(arg) ? arg : quoteTerm(arg)).join() +\n      \")\";\n  }\n}\n\nconst _curry_f = (name) => {\n  return (...args) => new SQLFunction(name, ...args)\n};\n\nconst AggregateFunctions = {\n  count: _curry_f('count'),\n  any: _curry_f('any'),\n  anyLast: _curry_f('anyLast'),\n  min: _curry_f('min'),\n  max: _curry_f('max'),\n  sum: _curry_f('sum'),\n  avg: _curry_f('avg'),\n  uniq: _curry_f('uniq'),\n  uniqCombined: _curry_f('uniqCombined'),\n  uniqHLL12: _curry_f('uniqHLL12'),\n  uniqExact: _curry_f('uniqExact'),\n  groupArray: _curry_f('groupArray'),\n  groupUniqArray: _curry_f('groupUniqArray')\n};\n\nconst ArithmeticFunctions = {\n  plus: _curry_f('plus'),\n  minus: _curry_f('minus'),\n  multiply: _curry_f('multiply'),\n  divide: _curry_f('divide'),\n  intDiv: _curry_f('intDiv'),\n  intDivOrZero: _curry_f('intDivOrZero'),\n  modulo: _curry_f('modulo'),\n  negate: _curry_f('negate'),\n  abs: _curry_f('abs')\n};\n\nconst TimeFunctions = {\n  toYear: _curry_f('toYear'),\n  toMonth: _curry_f('toMonth'),\n  toDayOfMonth: _curry_f('toDayOfMonth'),\n  toDayOfWeek: _curry_f('toDayOfWeek'),\n  toHour: _curry_f('toHour'),\n  toMinute: _curry_f('toMinute'),\n  toTime: _curry_f('toTime'),\n  toDate: _curry_f('toDate'),\n  toDateTime: _curry_f('toDateTime'),\n  toDateTime64: _curry_f('toDateTime64'),\n  toStartOfDay: _curry_f('toStartOfDay'),\n  toStartOfMonth: _curry_f('toStartOfMonth'),\n  toStartOfQuarter: _curry_f('toStartOfQuarter'),\n  toStartOfYear: _curry_f('toStartOfYear'),\n  toStartOfMinute: _curry_f('toStartOfMinute'),\n  toStartOfFiveMinute: _curry_f('toStartOfFiveMinute'),\n  toStartOfHour: _curry_f('toStartOfHour'),\n\n  now: _curry_f('now'),\n  today: _curry_f('today'),\n  yesterday: _curry_f('yesterday')\n};\n\nconst IPAddrFunctions = {\n  toIPv4: _curry_f('toIPv4'),\n  toIPv6: _curry_f('toIPv6'),\n  IPv4NumToString: _curry_f('IPv4NumToString'),\n  IPv4StringToNum: _curry_f('IPv4StringToNum'),\n  IPv4NumToStringClassC: _curry_f('IPv4NumToStringClassC'),\n  IPv6NumToString: _curry_f('IPv6NumToString'),\n  IPv6StringToNum: _curry_f('IPv6StringToNum')\n};\n\nclass Raw extends SQLObject {\n  constructor(string) {\n    super();\n    this.raw = string;\n  }\n\n  toString() {\n    return this.raw;\n  }\n}\n\nclass Query extends SQLObject {\n}\n\nclass Parameter extends SQLObject {\n  constructor(name) {\n    super()\n    this.name = name;\n    this.value = null;\n  }\n  set(value) {\n    this.value = value;\n  }\n  get() {\n    return this.value;\n  }\n  toString() {\n    if (typeof this.value === 'undefined') {\n      throw new Error('Unspecified parameter ' + this.name);\n    }\n    return this.value.toString();\n  }\n}\n\nclass With extends Query {\n  constructor(alias, query, inline) {\n    super();\n    this.alias = alias;\n    if (!query instanceof Select) {\n      throw new Error('query should be a select query');\n    }\n    this.query = query;\n    this.inline = inline;\n  }\n  toString() {\n    if (this.inline) {\n      return '';\n    }\n    this.fmt = undefined;\n    return `${this.alias} AS (${this.query.toString()})`\n  }\n}\n\nclass WithReference extends SQLObject {\n  constructor(ref) {\n    super();\n    if (!ref instanceof With) {\n      throw new Error('reference should be a With object');\n    }\n    this.ref = ref;\n  }\n  toString() {\n    if (this.ref.inline) {\n      return `(${this.ref.query.toString()}) as ${this.ref.alias}}`;\n    }\n    return this.ref.alias;\n  }\n}\n\nclass Subquery extends SQLObject {\n  /**\n   *\n   * @param query {Select}\n   */\n  constructor(query) {\n    super();\n    this.query = query;\n  }\n  toString() {\n    return `(${this.query})`;\n  }\n}\n\nclass UnionAll extends Query {\n  constructor(...queries) {\n    super();\n    this.queries = queries;\n  }\n  toString() {\n    return this.queries.join(' UNION ALL ');\n  }\n}\n\nclass Select extends Query {\n  constructor() {\n    super();\n    this._init()\n  }\n\n  _init(q) {\n    q = q || {};\n    this.ctx = q.ctx || {};\n    this.dist = false;\n    this.params = q.params || {};\n    this.withs = q.withs || {};\n    this.tables = q.tables || [];\n    this.joins = q.joins || [];\n    this.conditions = q.conditions || new Conjunction();\n    this.having_conditions = q.having_conditions || new Conjunction();\n    this.preconditions = q.preconditions || new Conjunction();\n    this.aggregations = q.aggregations || [];\n    this.select_list = q.select_list || [];\n    this.order_expressions = q.order_expressions || [];\n    this.request_totals = q.request_totals || undefined;\n    this.sampling = q.sampling || undefined;\n    this.limits = q.limits || undefined;\n    this.limitbycolumns = q.limitbycolumns || undefined;\n    this.fmt = q.fmt || undefined;\n  }\n\n  distinct(dist) {\n    this.dist = dist;\n    return this;\n  }\n\n  clone() {\n    const s = new Select();\n    s._init(this);\n    return s;\n  }\n\n  select(...columns) {\n    if (columns.length === 0) {\n      return this.select_list;\n    }\n\n    columns.forEach((col) => this.select_list.push(col));\n    return this;\n  }\n\n  /**\n   *\n   * @param queries {With}\n   */\n  with(...queries) {\n    if (!queries.length) {\n      return this.withs;\n    }\n    let withs = [];\n    for (const q of queries) {\n      withs.push.apply(withs, Object.values(q.query.withs ? q.query.withs : {}));\n      this.ctx = {...this.ctx, ...q.query.ctx};\n      this.params = {...this.params, ...q.query.params};\n      q.query.withs = {};\n    }\n    withs = [...withs, ...queries]\n    for (const q of withs) {\n      this.withs[q.alias] = q;\n      this.fmt = q.query.fmt || this.fmt;\n      q.query.fmt = undefined;\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param param {Parameter}\n   */\n  addParam(param) {\n    this.params[param.name] = param\n    return this;\n  }\n\n  /**\n   *\n   * @param name {string}\n   */\n  getParam(name) {\n    return this.params[name];\n  }\n\n  /**\n   * @usage\n   *  q = selectBuilder->from('table0', ['table1', 'alias1'], { 'table2' : 'alias2'})->toString()\n   *  assertEquals(q, \"select * from table0, table1 as alias1, table2 as alias2\");\n   *\n   * @param tables\n   * @return {Select|Array}\n   */\n  from(...tables) {\n    if (!tables.length) {\n      return this.tables;\n    }\n\n    tables = tables.map(table => {\n      if (typeof table === \"string\") return [quoteTerm(table)];\n      if (Array.isArray(table)) {\n        if (table[0] instanceof Query) table[0] = new Subquery(table[0]);\n        else if (table[0] instanceof SQLObject) table[0] = table[0];\n        else table[0] = quoteTerm(table[0]);\n        table[1] = quoteTerm(table[1]);\n        return table;\n      }\n      if (table instanceof Query) return [new Subquery(table)];\n      if (table instanceof SQLObject) return [table];\n\n      let alias = Object.values(table)[0];\n      if (alias instanceof Select) alias = '(' + alias.toString() + ')';\n      else alias = quoteTerm(alias);\n\n      return [alias, quoteTerm(Object.keys(table)[0])];\n    });\n\n    this.tables = tables;\n    return this;\n  }\n\n  join(table, type, ...conditions) {\n    if (typeof table === \"string\") table = quoteTerm(table);\n\n    if (!Array.isArray(conditions)) {\n      conditions = [conditions];\n    }\n\n    if (conditions.length > 1) {\n      conditions = Conjunction(conditions);\n    }\n\n    this.joins.push({ table, type, conditions });\n    return this;\n  }\n\n  prewhere(...args) {\n    this.preconditions.push(createCondition(...args));\n    return this;\n  }\n\n  orPrewhere(...args) {\n    let condition = createCondition(...args);\n    if (this.preconditions.length) {\n      this.preconditions = new Disjunction(this.preconditions, condition)\n    } else {\n      this.preconditions.push(condition)\n    }\n\n    return this;\n  }\n\n  where(...args) {\n    if (args.length === 1 && args[0] instanceof Condition) {\n      this.conditions.push(args[0]);\n    } else {\n      this.conditions.push(createCondition(...args));\n    }\n    return this;\n  }\n\n  orWhere(...args) {\n    let condition = createCondition(...args);\n    if (this.conditions.length) {\n      this.conditions = new Disjunction(this.conditions, condition)\n    } else {\n      this.conditions.push(condition);\n    }\n\n    return this;\n  }\n\n  groupBy(...aggregateExpressions) {\n    aggregateExpressions.forEach(a => this.aggregations.push(a));\n    return this;\n  }\n\n  withTotals(request_totals = true) {\n    this.request_totals = request_totals;\n    return this;\n  }\n\n  limit(number, offset) {\n    if (!number && !offset) {\n      this.limits = undefined\n      return this\n    }\n    this.limits = {\n      number, offset\n    };\n    return this;\n  }\n\n  limitBy(limit, ...columns) {\n    this.limitbycolumns = {\n      limit, columns\n    };\n    return this;\n  }\n\n  orderBy(...expressions) {\n    if (!expressions.length) {\n      return this.order_expressions;\n    }\n    this.order_expressions = expressions;\n    return this;\n  }\n\n  format(fmt) {\n    this.fmt = fmt;\n    return this;\n  }\n\n  having(...args) {\n    if (!args.length) {\n      return this.having_conditions;\n    }\n    if (args.length === 1 && args[0] instanceof Condition) {\n      this.having_conditions.push(args[0]);\n    } else {\n      this.having_conditions.push(createCondition(...args));\n    }\n    return this;\n  }\n\n  toString() {\n    let wth = Object.values(this.with()).filter(w => !w.inline);\n    wth = wth.length ? \"WITH \" + wth.join(', ') : '';\n    let select_list;\n    if (this.select_list.length === 0) {\n      select_list = \"*\";\n    } else {\n      select_list = this.select_list.map(\n        c => Array.isArray(c)\n          ? quoteTerm(c[0]) + ' as ' + quoteTerm(c[1])\n          : quoteTerm(c)\n      ).join();\n    }\n\n    const dist = this.dist ? 'DISTINCT' : '';\n\n    let from = this.from().map(\n      (table) =>\n        table.length === 1\n          ? table[0]\n          : table[0] + ' as ' + table[1]\n    );\n    from = from.length ? \"from \" + from.join() : \"\";\n\n    let join = this.joins.map((join) => {\n      const table = Array.isArray(join.table) && join.table.length > 1\n        ? [quoteTerm(join.table[0]), join.table[1]].join(' as ')\n        : join.table;\n      return ((join.type) ? join.type + ' ' : '') + 'join ' + table + ' on ' + join.conditions;\n    }).join(' ');\n\n    let prewhere = this.preconditions.length ? \"prewhere \" + this.preconditions : \"\";\n    let where = this.conditions.length ? \"where \" + this.conditions : \"\";\n\n    let groupby = this.aggregations.length\n      ? \"group by \" + this.aggregations.map(c => quoteTerm(c)).join()\n      : \"\";\n\n    let having = this.having_conditions.length ? \"having \" + this.having_conditions : \"\";\n\n    let order_by = this.order_expressions.length\n      ? \"order by \" + this.order_expressions.map(e => Array.isArray(e) ? quoteTerm(e[0]) + \" \" + e[1] : quoteTerm(e)).join()\n      : \"\";\n\n    let with_totals = this.request_totals ? \"with totals\" : \"\";\n    let sample = this.sampling ? \"sample \" + this.sampling : \"\";\n\n    let limitby = this.limitbycolumns && this.limitbycolumns.columns.length\n      ? \"limit \" + this.limitbycolumns.limit + \" by \" + this.limitbycolumns.columns.map(c => quoteTerm(c)).join()\n      : '';\n\n\n    let limit = this.limits\n      ? \"limit \" + ((typeof this.limits.offset === \"undefined\") ? this.limits.number : this.limits.offset + \", \" + this.limits.number)\n      : '';\n\n    let format = this.fmt\n      ? \" format \" + this.fmt.toUpperCase()\n      : \"\";\n\n    const parts = [\n      wth,\n      \"select\",\n      dist,\n      select_list,\n      from,\n      join,\n      sample,\n      prewhere,\n      where,\n      groupby,\n      with_totals,\n      having,\n      order_by,\n      limitby,\n      limit,\n      format,\n    ].filter((v) => v && v != '');\n\n    return parts.join(' ');\n  }\n}\n\n\nconst Queries = {\n  Select,\n  With,\n  WithReference,\n  Raw,\n  UnionAll\n};\n\n\nconst Utility = {\n  quoteVal, val: quoteVal,\n  quoteTerm, term: quoteTerm,\n  raw: (s) => new Raw(s),\n  Condition: (...args) => new Condition(...args),\n  Parameter\n};\n\n\nconst Shortcuts = {\n  And: (...args) => new Conjunction(...args),\n  Or: (...args) => new Disjunction(...args),\n  Eq: (col, val) => new Condition(col, Consts.EQ, val),\n  Ne: (col, val) => new Condition(col, Consts.NE, val),\n  Gte: (col, val) => new Condition(col, Consts.GTE, val),\n  Lte: (col, val) => new Condition(col, Consts.LTE, val),\n  Lt: (col, val) => new Condition(col, Consts.LT, val),\n  Gt: (col, val) => new Condition(col, Consts.GT, val),\n  in: (col, values) => new In(col, null, values),\n  notIn: (col, values) => new NotIn(col, null, values),\n  cast: (thing, t) => new SQLFunction('cast', thing, quoteVal(t)),\n  between: (col, left, right) => new Between(col, left, right)\n};\n\n\nconst Dialect = {\n  ...Operators,\n  ...AggregateFunctions,\n  ...ArithmeticFunctions,\n  ...TimeFunctions,\n  ...IPAddrFunctions,\n  ...Consts,\n  ...Queries,\n  ...Utility,\n  ...Shortcuts,\n};\nexport default Dialect;\n"],"file":"index.js"}